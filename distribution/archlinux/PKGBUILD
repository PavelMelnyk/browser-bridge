# Maintainer: Tim Gerhard <tim-gerhard@schnellbach-beltheim.de>
pkgname=browser-bridge
pkgver=0.1
pkgrel=1
depends=()
makedepends=('go')
pkgdesc="Open URLs on another computer"
arch=('any')
url="http://code.google.com/p/browser-bridge/"
license=('GPL')
options=(!strip)
source=(http://browser-bridge.googlecode.com/files/browserbridge_v0.1_source.tar.gz paths.patch)
md5sums=(05718bfb81de6def44eb5c7f3aeb4570 d5d4ca2546e2491a30112302e23564ef)

build() {
	cd $srcdir/browserbridge

	# this patch allows to put the config file to /etc/browserbridge/browserbridge.conf instead of /etc/browserbridge.conf
	patch src/paths.go -i ../paths.patch -o ./paths.go
	
	# compile
	8g src/copyright_notice.go
	8g ./paths.go
	8g src/browserbridge_config.go
	8g src/browserbridge_client.go
	8g src/browserbridge_server.go

	# create dest dir
	mkdir -p ${pkgdir}/usr/bin

	# link
	8l -o ${pkgdir}/usr/bin/browser-bridge browserbridge_client.8
	8l -o ${pkgdir}/usr/bin/browser-bridge_server browserbridge_server.8
}

package() {
	cd $srcdir/browserbridge
	mkdir -p ${pkgdir}/etc/browserbridge/
	install -m644 browserbridge.conf ${pkgdir}/etc/browserbridge/
}
